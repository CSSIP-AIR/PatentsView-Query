define(["jquery","underscore","backbone","handlebars","text!views/query/templates/SelectResults.html","text!views/query/templates/OutputListsPatent.html","text!views/query/templates/OutputListsAssignee.html","text!views/query/templates/OutputListsInventor.html","text!views/query/templates/OutputLists.html","bootstrap","validate"],function(e,t,n,r,i,s,o,u,a){var f=n.View.extend({tagName:"section",className:"step-view",id:"selectResults",initialize:function(e){this.listenTo(this.model,"entityChanged",this.entityChanged),t.bindAll(this,"render","updateModel"),this.template=r.compile(i),this.outputListPatent=r.compile(s),this.outputListAssignee=r.compile(o),this.outputListInventor=r.compile(u),this.outputList=r.compile(a),this.resetView=!0},events:{"change .category":"changeCategory","change .output":"changeOutput","click .list-group-item":"listGroupItemClick"},render:function(t){return t==1&&this.resetView==1&&(e(this.el).empty(),e(this.el).append(this.template(this.model.toJSON())),this.renderOutputs(),this.resetView=!1),this},entityChanged:function(e){this.resetView=!0},listGroupItemClick:function(t){t=t||window.event;var n=e(t.srcElement||t.target);e(n).hasClass("list-group-item")&&(e(n).toggleClass("collapsed"),e(e(n).data("target")).collapse("toggle"))},changeCategory:function(t){t=t||window.event;var n=e(t.srcElement||t.target),r=n[0].checked,i=e(n).closest(".list-group");i.find(".output").prop("checked",r),i.find(".category").prop("checked",r),r&&(e(n).closest(".list-group-item").toggleClass("collapsed"),e(i.find(".list-group-item").data("target")).collapse("show"))},changeOutput:function(t){t=t||window.event;var n=e(t.srcElement||t.target);e(n).closest(".list-group-submenu").find(".output").length>e(n).closest(".list-group-submenu").find(".output:checked").length?e(n).closest(".list-group").find(".category").prop("checked",!1):e(n).closest(".list-group").find(".category").prop("checked",!0)},updateModel:function(){var t=[],n=e(this.el).find(".output:checked").each(function(n,r){t.push(e(r).val())});this.model.set("outputIds",t)},expandParent:function(t){var n=e(t).find('input[type="checkbox"]:checked');if(n.length>0){var r=n.closest(".list-group-submenu");r.addClass("in"),r.closest(".list-group").find('[data-target="#'+r.attr("id")+'"]').removeClass("collapsed")}},renderOutputs:function(){var n=this.model.get("entityId"),r=this.model.getOutputs(),i=this.outputList(t.find(r,{categoryId:"Patent"})),s=this.outputList(t.find(r,{categoryId:"Inventor"})),o=this.outputList(t.find(r,{categoryId:"Assignee"})),u=this.outputList(t.find(r,{categoryId:"Citations"})),a=this.outputList(t.find(r,{categoryId:"Technology_Classifications"}));switch(n){case"inventor":e(this.el).find("#outputs").html(this.outputListInventor({})),e(this.el).find("#patent-outputs").html(i),e(this.el).find("#inventor-outputs").html(s),e(this.el).find("#assignee-outputs").html(o),e(this.el).find("#technology_Classifications-outputs").html(a),this.expandParent(e(this.el).find("#patent-outputs")),this.expandParent(e(this.el).find("#inventor-outputs")),this.expandParent(e(this.el).find("#assignee-outputs")),this.expandParent(e(this.el).find("#technology_Classifications-outputs"));break;case"assignee":e(this.el).find("#outputs").html(this.outputListAssignee({})),e(this.el).find("#patent-outputs").html(i),e(this.el).find("#inventor-outputs").html(s),e(this.el).find("#assignee-outputs").html(o),e(this.el).find("#technology_Classifications-outputs").html(a),this.expandParent(e(this.el).find("#patent-outputs")),this.expandParent(e(this.el).find("#inventor-outputs")),this.expandParent(e(this.el).find("#assignee-outputs")),this.expandParent(e(this.el).find("#technology_Classifications-outputs"));break;default:e(this.el).find("#outputs").html(this.outputListPatent({})),e(this.el).find("#patent-outputs").html(i),e(this.el).find("#inventor-outputs").html(s),e(this.el).find("#assignee-outputs").html(o),e(this.el).find("#citations-outputs").html(u),e(this.el).find("#technology_Classifications-outputs").html(a),this.expandParent(e(this.el).find("#patent-outputs")),this.expandParent(e(this.el).find("#inventor-outputs")),this.expandParent(e(this.el).find("#assignee-outputs")),this.expandParent(e(this.el).find("#citations-outputs")),this.expandParent(e(this.el).find("#technology_Classifications-outputs"))}},getNavHtml:function(e){return""},getNextHtml:function(){return'Preview Query <i class="fa fa-caret-right" />'}});return f});